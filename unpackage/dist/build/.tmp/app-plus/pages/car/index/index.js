(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/car/index/index"],{"0814":function(t,e,n){"use strict";n.r(e);var a=n("4cf9"),i=n.n(a);for(var r in a)"default"!==r&&function(t){n.d(e,t,function(){return a[t]})}(r);e["default"]=i.a},"09ed":function(t,e,n){"use strict";n.r(e);var a=n("eaba"),i=n.n(a);for(var r in a)"default"!==r&&function(t){n.d(e,t,function(){return a[t]})}(r);e["default"]=i.a},"0e09":function(t,e,n){"use strict";var a=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("view",{staticClass:"carPay"},[n("view",{staticClass:"allChecked",attrs:{eventid:"71e35920-0"},on:{tap:t.choseAllClick}},[n("view",{staticClass:"checkbox",class:{active:t.isChoseAll}}),n("text",[t._v("全选")])]),t.carStatus?n("view",{staticClass:"car-totalMoney"},[t._v("合计："),n("text",[t._v("￥"+t._s(t.totalPriceFormat))])]):t._e(),t.carStatus?n("button",{attrs:{eventid:"71e35920-2"},on:{tap:t.pay}},[t._v("结算")]):n("button",{staticClass:"del-btn",attrs:{eventid:"71e35920-1"},on:{tap:t.del}},[t._v("删除")])],1)},i=[];n.d(e,"a",function(){return a}),n.d(e,"b",function(){return i})},"1cbd":function(t,e,n){},"25f8":function(t,e,n){"use strict";n.r(e);var a=n("0e09"),i=n("f7b4");for(var r in i)"default"!==r&&function(t){n.d(e,t,function(){return i[t]})}(r);n("e8a6");var c=n("2877"),o=Object(c["a"])(i["default"],a["a"],a["b"],!1,null,"0985654b",null);e["default"]=o.exports},3234:function(t,e,n){"use strict";var a=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("view",{staticClass:"car-list"},[n("car-item",{attrs:{goToDetail:t.goToDetail,carList:t.carList,changeNumber:t.changeNumber,singleClick:t.singleClick,eventid:"6af3d1b4-0",mpcomid:"6af3d1b4-0"},on:{input:t.input}})],1)},i=[];n.d(e,"a",function(){return a}),n.d(e,"b",function(){return i})},"3b4d":function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var a={props:{carStatus:Boolean,pay:Function,del:Function,choseAllClick:Function,isChoseAll:Boolean,totalPrice:Number},data:function(){return{}},computed:{totalPriceFormat:function(){return this.totalPrice.toFixed(2)}}};e.default=a},"43bf":function(t,e,n){"use strict";var a=n("9168"),i=n.n(a);i.a},4722:function(t,e,n){"use strict";n.r(e);var a=n("9426"),i=n.n(a);for(var r in a)"default"!==r&&function(t){n.d(e,t,function(){return a[t]})}(r);e["default"]=i.a},"4cf9":function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var a=i(n("53e9"));function i(t){return t&&t.__esModule?t:{default:t}}var r={props:{carList:{type:[Array,Object]},singleClick:Function,changeNumber:Function,goToDetail:Function,changeInputNumber:Function},data:function(){return{}},methods:{input:function(t){this.$emit("input",{value:t.value,item:t.item})}},components:{carItem:a.default}};e.default=r},"4e47":function(t,e,n){},"53e9":function(t,e,n){"use strict";n.r(e);var a=n("64ef"),i=n("4722");for(var r in i)"default"!==r&&function(t){n.d(e,t,function(){return i[t]})}(r);n("43bf");var c=n("2877"),o=Object(c["a"])(i["default"],a["a"],a["b"],!1,null,"25bedc36",null);e["default"]=o.exports},"64ef":function(t,e,n){"use strict";var a=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("view",[t._l(t.carList,function(e,a){return n("view",{key:a,staticClass:"car-item"},[n("view",{staticClass:"checkbox",class:{active:e.checked},attrs:{eventid:"6af63cca-0-"+a},on:{tap:function(n){t.singleClick(e)}}}),n("image",{staticClass:"car-item-img",attrs:{src:e.goods_image,eventid:"6af63cca-1-"+a},on:{tap:function(n){t.goToDetail(e)}}}),n("view",{staticClass:"car-item-info"},[n("view",{staticClass:"item-name",attrs:{eventid:"6af63cca-2-"+a},on:{tap:function(n){t.goToDetail(e)}}},[t._v(t._s(e.name))]),n("view",{staticClass:"item-price"},[n("text",[t._v(t._s("￥"+e.sinleCarPrice))]),n("view",{staticClass:"number-box"},[n("view",{attrs:{eventid:"6af63cca-3-"+a},on:{tap:function(n){t.changeNumber(e,"minus")}}},[t._v("-")]),n("input",{directives:[{name:"model",rawName:"v-model",value:e.num,expression:"item.num"}],attrs:{disabled:"",type:"number",value:e.num,eventid:"6af63cca-4-"+a},domProps:{value:e.num},on:{input:[function(t){t.target.composing||(e.num=t.target.value)},function(n){t.$emit("input",{value:n.target.value,item:e})}]}}),n("view",{attrs:{eventid:"6af63cca-5-"+a},on:{tap:function(n){t.changeNumber(e,"plus")}}},[t._v("+")])])])])])}),t.carList.length<=0?n("view",{staticClass:"nodata"},[n("image",{attrs:{src:"/static/images/mine/nodata1.png"}}),n("view",[t._v("没有更多了...")])]):t._e()],2)},i=[];n.d(e,"a",function(){return a}),n.d(e,"b",function(){return i})},"822a":function(t,e,n){"use strict";var a=n("9f04"),i=n.n(a);i.a},9168:function(t,e,n){},9426:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var a={props:{carList:{type:[Array,Object]},singleClick:Function,changeNumber:Function,goToDetail:Function,changeInputNumber:Function},data:function(){return{singleChecked:!1,allChecked:!1}},computed:{},watch:{carList:function(){console.log(222222)}},methods:{},components:{}};e.default=a},"968d":function(t,e,n){"use strict";n("4b50");var a=r(n("b0ce")),i=r(n("b707"));function r(t){return t&&t.__esModule?t:{default:t}}Page((0,a.default)(i.default))},"9f04":function(t,e,n){},b707:function(t,e,n){"use strict";n.r(e);var a=n("f8a3"),i=n("09ed");for(var r in i)"default"!==r&&function(t){n.d(e,t,function(){return i[t]})}(r);n("822a");var c=n("2877"),o=Object(c["a"])(i["default"],a["a"],a["b"],!1,null,"1414b84e",null);e["default"]=o.exports},cab2:function(t,e,n){"use strict";n.r(e);var a=n("3234"),i=n("0814");for(var r in i)"default"!==r&&function(t){n.d(e,t,function(){return i[t]})}(r);n("d64b");var c=n("2877"),o=Object(c["a"])(i["default"],a["a"],a["b"],!1,null,"3fd80614",null);e["default"]=o.exports},d64b:function(t,e,n){"use strict";var a=n("4e47"),i=n.n(a);i.a},e8a6:function(t,e,n){"use strict";var a=n("1cbd"),i=n.n(a);i.a},eaba:function(t,e,n){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var a=o(n("a34a")),i=o(n("cab2")),r=o(n("25f8")),c=n("78dd");function o(t){return t&&t.__esModule?t:{default:t}}function s(t,e){return f(t)||l(t,e)||u()}function u(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function l(t,e){var n=[],a=!0,i=!1,r=void 0;try{for(var c,o=t[Symbol.iterator]();!(a=(c=o.next()).done);a=!0)if(n.push(c.value),e&&n.length===e)break}catch(s){i=!0,r=s}finally{try{a||null==o["return"]||o["return"]()}finally{if(i)throw r}}return n}function f(t){if(Array.isArray(t))return t}function d(t,e,n,a,i,r,c){try{var o=t[r](c),s=o.value}catch(u){return void n(u)}o.done?e(s):Promise.resolve(s).then(a,i)}function h(t){return function(){var e=this,n=arguments;return new Promise(function(a,i){var r=t.apply(e,n);function c(t){d(r,a,i,c,o,"next",t)}function o(t){d(r,a,i,c,o,"throw",t)}c(void 0)})}}var v={data:function(){return{carList:[],isChoseAll:!1,carStatus:!0,totalPrice:0}},onShow:function(){this._getShopInfo(),this.isChoseAll=!1,this.totalPrice=0,this.carStatus=!0},methods:{changeNumber:function(){var e=h(a.default.mark(function e(n,i){var r,o;return a.default.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if("minus"!=i){e.next=10;break}if(!(n.num<=1)){e.next=4;break}return t.showToast({title:"宝贝不能再减少了哦",icon:"none"}),e.abrupt("return");case 4:return e.next=6,(0,c.changeShopCarNumber)({xgoods_id:n.xgoods_id,num:n.num-1,token:t.getStorageSync("token")});case 6:r=e.sent,1e4==r.recode&&(n.num=r.data.num,n.price=r.data.price,this.formatSingePrice()),console.log(r),this.countTotalPrice();case 10:if("plus"!=i){e.next=17;break}return e.next=13,(0,c.changeShopCarNumber)({xgoods_id:n.xgoods_id,num:Number(n.num)+1,token:t.getStorageSync("token")});case 13:o=e.sent,console.log(o),1e4==o.recode?(n.num=o.data.num,n.price=o.data.price,this.formatSingePrice()):t.showToast({title:o.remsg,icon:"none"}),this.countTotalPrice();case 17:case"end":return e.stop()}},e,this)}));function n(t,n){return e.apply(this,arguments)}return n}(),formatSingePrice:function(){var t=this;this.carList.forEach(function(e,n){console.log(e);var a=(e.num*e.price).toFixed(2);t.$set(e,"sinleCarPrice",a)}),this.carList=this.carList},changeInputNumber:function(){var e=h(a.default.mark(function e(n){var i,r;return a.default.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return n.value,i=n.item.price,e.next=4,(0,c.changeShopCarNumber)({xgoods_id:n.item.xgoods_id,num:n.value,token:t.getStorageSync("token")});case 4:r=e.sent,console.log(JSON.stringify(r)),1e4==r.recode?(n.item.num=n.value,this.formatSingePrice()):10003==r.recode?(n.item.num=1,n.item.sinleCarPrice=n.value*i,this.formatSingePrice(),t.showToast({title:r.remsg,icon:"none"})):(n.item.num=r.data.num,this.formatSingePrice(),t.showToast({title:r.remsg,icon:"none"}));case 7:case"end":return e.stop()}},e,this)}));function n(t){return e.apply(this,arguments)}return n}(),singleClick:function(t){"undefined"==t.checked?this.$set(t,"checked",!0):this.$set(t,"checked",!t.checked),this.judgeIsChoseAll(),this.countTotalPrice()},judgeIsChoseAll:function(){var t=!0;this.carList.length<=0?t=!1:this.carList.forEach(function(e,n){e.checked||(t=!1)}),this.isChoseAll=t},choseAllClick:function(){var t=this;this.isChoseAll=!this.isChoseAll,Object.values(this.carList).forEach(function(e,n){e.checked,t.$set(e,"checked",t.isChoseAll)}),this.countTotalPrice()},countTotalPrice:function(){var t=0;Object.values(this.carList).forEach(function(e,n){e.checked&&(t+=e.price*e.num)}),this.totalPrice=t},_getShopInfo:function(){var e=h(a.default.mark(function e(){var n,i;return a.default.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(n=t.getStorageSync("token"),n){e.next=4;break}return this.$dealLogin(),e.abrupt("return");case 4:return t.showLoading({title:"正在加载数据..."}),this.carList=[],e.next=8,(0,c.getShopCarInfo)({token:t.getStorageSync("token")});case 8:if(i=e.sent,t.hideLoading(),10001!=i.recode){e.next=13;break}return t.redirectTo({url:"/pages/login/login/login",animationType:"slide-in-right"}),e.abrupt("return");case 13:1e4==i.recode?(this.carList=i.data,this.carList.forEach(function(t,e){var n=(t.num*t.price).toFixed(2);t.sinleCarPrice=n}),this.carList=this.carList):t.showToast({title:i.remsg,icon:"none"});case 14:case"end":return e.stop()}},e,this)}));function n(){return e.apply(this,arguments)}return n}(),goToDetail:function(){var e=h(a.default.mark(function e(n){return a.default.wrap(function(e){while(1)switch(e.prev=e.next){case 0:t.navigateTo({url:"/pages/home/subPages/mealDetail/mealDetail?id="+n.xgoods_id,animationType:"slide-in-right"});case 1:case"end":return e.stop()}},e,this)}));function n(t){return e.apply(this,arguments)}return n}(),pay:function(){var e=[];this.carList.forEach(function(t,n){t.checked&&e.push(t.id)});JSON.stringify(e);e.length<=0?t.showToast({title:"请至少选择一个商品",icon:"none"}):t.request({method:"POST",url:c.BASE_URL+"/app/close/close",data:{shop:e,token:t.getStorageSync("token")}}).then(function(n){var a=s(n,2),i=(a[0],a[1]);if(console.log(i),1e4==i.data.recode){var r=JSON.stringify(i.data.data);t.navigateTo({url:"/pages/car/subPages/pay/pay?data="+r+"&carId="+e,animationType:"slide-in-right"})}})},del:function(){var e=h(a.default.mark(function e(){var n,i;return a.default.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(n=this,i=[],this.carList.forEach(function(t,e){t.checked&&i.push(t.id)}),!(i.length<=0)){e.next=6;break}return t.showToast({title:"请至少选择一个商品",icon:"none"}),e.abrupt("return");case 6:t.showModal({title:"提示",content:"确定要删除此商品吗？",success:function(e){e.confirm&&t.request({method:"POST",url:c.BASE_URL+"/app/shopping/deleteGoods",header:{"content-type":"application/json"},data:{cart_id:i,token:t.getStorageSync("token")},success:function(e){1e4==e.data.recode?(t.showToast({title:"删除成功"}),n._getShopInfo(),n.countTotalPrice(),n.judgeIsChoseAll()):t.showToast({title:e.data.remsg,icon:"none"})}})}});case 7:case"end":return e.stop()}},e,this)}));function n(){return e.apply(this,arguments)}return n}()},onNavigationBarButtonTap:function(t){var e=this,n=getCurrentPages(),a=n[n.length-1],i=a.$getAppWebview(),r=i.getStyle().titleNView;console.log(JSON.stringify(r)),r.buttons&&(r.buttons[0].text="管理"==r.buttons[0].text?"完成":"管理",e.carStatus="管理"==r.buttons[0].text,i.setStyle({titleNView:r}))},components:{carList:i.default,carPay:r.default}};e.default=v}).call(this,n("6e42")["default"])},f7b4:function(t,e,n){"use strict";n.r(e);var a=n("3b4d"),i=n.n(a);for(var r in a)"default"!==r&&function(t){n.d(e,t,function(){return a[t]})}(r);e["default"]=i.a},f8a3:function(t,e,n){"use strict";var a=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("view",[n("view",{staticClass:"carList"},[n("car-list",{attrs:{goToDetail:t.goToDetail,changeNumber:t.changeNumber,carList:t.carList,singleClick:t.singleClick,eventid:"756c651e-0",mpcomid:"756c651e-0"},on:{input:t.changeInputNumber}}),n("car-pay",{attrs:{totalPrice:t.totalPrice,choseAllClick:t.choseAllClick,isChoseAll:t.isChoseAll,carStatus:t.carStatus,pay:t.pay,del:t.del,mpcomid:"756c651e-1"}})],1)])},i=[];n.d(e,"a",function(){return a}),n.d(e,"b",function(){return i})}},[["968d","common/runtime","common/vendor"]]]);